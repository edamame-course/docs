<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width">

        <title>EDAMAME : QIIME Tutorial 2</title>
        <meta name="description" content="course materials & tutorials">

        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css" rel="stylesheet">
        <link rel="stylesheet" href="/css/syntax.css">
        <link rel="stylesheet" href="/css/main.css">
    </head>
    <body>

        <div class="container">
            <div class=row-fluid>
                <div id=header class=span12>
                    <h4><a class=brand href="http://edamame-course.org">EDAMAME</a>
    <small>course materials & tutorials</small>
</h4>

                </div>
            </div>

            <div class=row-fluid>
                
                
                    <div id=navigation class=span3>
                        
<ul class="nav nav-list">
    <li class=nav-header>HOME</li>
    <li><a href="index.html">EDAMAME course materials</a></li>
    <li class=divider></li>
    <li class=nav-header>Before We Begin</li>
    <li><a href="https://edamame-course.github.io/docs/general_set_up_guidelines.html">Getting Set Up For The Course</a></li>
    <li><a href="https://edamame-course.github.io/docs/intro_to_ec2_instance.html">All Users: Setting up an EC2 instance</a></li>
    <li><a href="https://edamame-course.github.io/docs/mobaxterm.html">Windows Users: Connecting to your AWS EC2 instance</a></li>
    <li><a href="https://edamame-course.github.io/docs/mac_os_linux_connect_to_ec2.html">Mac and Linux Users: Connecting to your AWS EC2 instance</a></li>
    <li><a href="https://edamame-course.github.io/docs/extra/macqiime_installation.html">Mac Users: Installing MacQIIME</a></li>
    <li><a href="https://edamame-course.github.io/docs/QIIME_VB_for_Windows.html">Windows Users: Installing a Virtual Box to run QIIME on your own Windows computer</a></li>
    <li class=divider></li>
    <li class=nav-header>Wednesday, August 13th</li>
    <li><a href="https://edamame-course.github.io/docs/august_13.html">Wednesday, August 13th Overview</a></li>
    <li class=divider></li>
    <li class=nav-header>Thursday, August 14th</li>
    <li><a href="https://edamame-course.github.io/docs/august_14.html">Thursday, August 14th Overview</a></li>
    <li class=divider></li>
    <li class=nav-header>Friday, August 15th</li>
    <!-- <li><a href="http://edamame-course.org">EDAMAME course home page</a></li> -->
    <li class=divider></li>
    <li class=nav-header>Saturday, August 16th</li>
    <!-- <li><a href="http://edamame-course.org">EDAMAME course home page</a></li> -->
    <li class=divider></li>
    <li class=nav-header>Sunday, August 17th</li>
    <!-- <li><a href="http://edamame-course.org">EDAMAME course home page</a></li> -->
    <li class=divider></li>
    <li class=nav-header>Monday, August 18th</li>
    <!-- <li><a href="http://edamame-course.org">EDAMAME course home page</a></li> -->
    <li class=divider></li>
    <li class=nav-header>Tuesday, August 19th</li>
    <!-- <li><a href="http://edamame-course.org">EDAMAME course home page</a></li> -->
    <li class=divider></li>
    <li class=nav-header>Wednesday, August 20th</li>
    <!-- <li><a href="http://edamame-course.org">EDAMAME course home page</a></li> -->
    <li class=divider></li>
</ul>

                    </div>

                    <div id=content class=span9>
                        <div class=page-header>
    <h2>QIIME Tutorial 2
        
    </h2>
</div>

<p>Welcome back, Microbe Enthusiasts!</p>

<h2 id="creating-an-otu-table-in-qiime">Creating an OTU table in QIIME</h2>

<p>Previously, we left off with quality-controlled merged Illumina paired-end sequences, picked OTUs and an alignment of the representative sequences from those OTUs.</p>

<h3 id="3.1-assign-taxonomy-to-representative-sequences**">3.1  Assign taxonomy to representative sequences**</h3>

<p>Navigate into the QIIMETutorial directory using <code>cd</code>, and, enter the QIIME environment. We will use the RDP classifier with a greengenes 16S rRNA reference database (both default options in QIIME).  This script will take a few minutes to run on a lap-top. Documentation is <a href="http://qiime.org/scripts/assign_taxonomy.html">here</a>.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">assign_taxonomy.py -i cdhit_rep_seqs/cdhit_rep_seqs.fasta -m rdp -c 0.8
</code></pre></div>
<p>Navigate into the new rdp_assigned_taxonomy directory and inspect the head of the tax_assignments file.
<code>
head cdhit_rep_seqs_tax_assignments.txt
</code></p>

<p><img src="https://github.com/edamame-course/docs/raw/gh-pages/img/QIIMETutorial2_IMG/IMG_11.jpg" alt="img11"></p>

<p>This assignment file is used anytime an OTU ID (the number) needs to be linked with its taxonomic assignment.
<em>Note</em> that this list of OTUs and taxonomic assignments includes our &quot;failed-to-align&quot; representative sequences.  We will remove these at the next step.</p>

<h3 id="3.2-make-an-otu-table,-append-the-assigned-taxonomy,-and-exclude-failed-alignment-otus">3.2  Make an OTU table, append the assigned taxonomy, and exclude failed alignment OTUs</h3>

<p>The OTU table is the table on which all ecological analyses (e.g. diversity, patterns, etc) is performed.  However, building the OTU table is non-contentious (you just count how many of each OTU was observed in each sample).  Instead, every step up until building the OTU table is important.  The algorithms that are chosen to assemble reads, quality control reads, define OTUs, etc are all gearing up to this one summarization. Documentation for make_otu_table.py is <a href="http://qiime.org/scripts/make_otu_table.html">here</a>. Note that the &quot;map&quot; file is not the actually mapping file, but the OTU cluster file (the output of cdhit).
Navigate back into the &quot;QIIMETutorial&quot; directory to execute the script.
<code>
make_otu_table.py -i cdhit_picked_otus/combined_seqs_otus.txt -o Schloss_otu_table.biom -e pynast_aligned/cdhit_rep_seqs_failures_names.txt -t rdp_assigned_taxonomy/cdhit_rep_seqs_tax_assignments.txt
</code>
We used our previously-created list of failed-seq-alignments with the <code>-e</code> option to exclude these OTUs.
Inspect the .biom table.
<code>
head Schloss_otu_table.biom
</code>
<img src="https://github.com/edamame-course/docs/raw/gh-pages/img/QIIMETutorial2_IMG/IMG_12.jpg" alt="img12"></p>

<p>Be not alarmed! This file is in .biom table format.  Whereas a traditional taxon (OTU) table in ecology is often a matrix of samples (communities) by taxa (OTUs), there are just too many taxa in microbial communities for the traditional table to be efficiently used in computation.  Thus, some of the QIIME folks developed the .biom format.  Documentation about the .biom format is <a href="http://biom-format.org/">here</a>.  If you scroll down on your terminal screen, you will see that the taxonomic assignments were incorporated into the OTU table.</p>

<p>We can get a summary of everything in the .biom OTU table.  <strong>This is an important script.</strong>  Documentation is <a href="http://biom-format.org/documentation/summarizing_biom_tables.html">here</a>
<code>
biom summarize_table -i Schloss_otu_table.biom -o summary_Schloss_otu_table.biom
</code></p>

<h3 id="3.2-sanity-check-#3">3.2  Sanity check #3</h3>

<p>How can we be sure that our failed alignment sequences were excluded from the OTU table?</p>

<h2 id="where-to-find-qiime-resources-and-help">Where to find QIIME resources and help</h2>

<ul>
<li> <a href="qiime.org">QIIME</a> offers a suite of developer-designed <a href="http://www.qiime.org/tutorials/tutorial.html">tutorials</a>.</li>
<li> <a href="http://www.qiime.org/scripts/index.html">Documentation</a> for all QIIME scripts.</li>
<li> There is a very active <a href="https://groups.google.com/forum/#!forum/qiime-forum">QIIME Forum</a> on Google Groups.  This is a great place to troubleshoot problems, responses often are returned in a few hours!</li>
<li> The <a href="http://qiime.wordpress.com/">QIIME Blog</a> provides updates like bug fixes, new features, and new releases.</li>
<li> QIIME development is on <a href="https://github.com/biocore/qiime">GitHub</a>.</li>
</ul>

<hr>

<hr>


<div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'edamame'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    

                    </div>

                
            </div>


            <div class=row-fluid>
                <div id=footer class=span12>
                    Documentation for <a href="http://edamame-course.org">EDAMAME</a>.

                </div>
            </div>
        </div>

        <script>
            function orderNav() {
                var list,
                    section,
                    header,
                    sections = [],
                    lists = {},
                    headers = {};

                var navUl = document.querySelectorAll('#navigation ul')[0],
                    navLis = document.querySelectorAll('#navigation ul li');

                if (!navUl) return;

                for (var i = 0; i < navLis.length; i++) {
                    var order, li = navLis[i];

                    if (li.classList.contains('nav-header')) {
                        section = li.textContent || li.innerText;
                        sections.push(section);
                        headers[section] = li;
                        continue;
                    }

                    if (!lists[section]) {
                        lists[section] = [];
                    }

                    order = parseFloat(li.getAttribute('data-order'))
                    lists[section].push([order, li]);
                }

                for (var i = 0; i < sections.length; i++) {
                    section = sections[i];
                    list = lists[section].sort(function(a, b) {
                        return a[0] - b[0];
                    });

                    if (header = headers[section]) {
                        navUl.appendChild(header);
                    }
                    for (var j = 0; j < list.length; j++) {
                        navUl.appendChild(list[j][1]);
                    }
                }
            }

            if (document.querySelectorAll) orderNav();
        </script>
    </body>
</html>
